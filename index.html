<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Laboratory Usage System</title>
<link rel="icon" type="image/png" href="gs.jfif">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
  :root{
    --gsc-blue:#1e3a8a;
    --gsc-accent:#2563eb;
    --gsc-bg:#f1f5f9;
    --text:#222;
    --card-bg:#ffffff;
  }
  body{font-family:Segoe UI,Arial,sans-serif;margin:0;background:var(--gsc-bg);color:var(--text)}
  header{background:var(--card-bg);color:var(--gsc-blue);padding:15px 20px;box-shadow:0 4px 10px rgba(0,0,0,.08);border-bottom:4px solid var(--gsc-blue)}
  .header-container{display:flex;align-items:center;gap:18px;max-width:1100px;margin:0 auto;width:100%}
  .gsc-logo{width:100px;height:auto}
  .header-text h1{margin:0;font-size:22px;color:var(--gsc-blue)}
  .header-text p{margin:4px 0 0;font-size:14px;color:var(--gsc-accent);font-weight:500}
  nav{max-width:1100px;margin:16px auto 0;padding:0 20px;display:flex;gap:10px}
  .tab{background:var(--card-bg);padding:10px 16px;border-radius:8px;border:1px solid #e6eefc;cursor:pointer;font-weight:600;color:var(--gsc-blue)}
  .tab.active{background:linear-gradient(90deg,var(--gsc-blue),var(--gsc-accent));color:white;border-color:transparent}
  main{max-width:1100px;margin:18px auto;padding:0 20px 40px}
  .card{background:var(--card-bg);border-radius:12px;padding:18px;box-shadow:0 6px 16px rgba(15,23,42,.04);margin-bottom:18px}
  input,textarea,select,button{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ced4da;border-radius:6px;font-size:14px}
  label{font-weight:600;font-size:13px;color:var(--gsc-blue);display:block;margin-bottom:4px;}
  button.primary{background:var(--gsc-accent);color:white;border:none;cursor:pointer;font-weight:700}
  button.secondary{background:#fff;border:1px solid #ddd;color:#333;cursor:pointer}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .row .col{flex:1;min-width:150px}
  .controls{display:flex;gap:10px;justify-content:flex-end;margin-bottom:12px;flex-wrap:wrap}
  table{width:100%;border-collapse:collapse;background:var(--card-bg);border-radius:8px;overflow:hidden;box-shadow:0 6px 16px rgba(15,23,42,.04)}
  th,td{padding:10px;border:1px solid #e6eefc;text-align:left;font-size:13px;white-space:nowrap}
  th{background:var(--gsc-blue);color:white;font-weight:700}
  tr:nth-child(even) td{background:#fbfdff}
  .list-area{width:260px;max-height:220px;overflow:auto;padding:6px 8px;border-left:1px solid #eef4ff}
  .list-item{display:flex;justify-content:space-between;padding:6px 4px;border-bottom:1px dashed #f1f6ff;font-size:13px}
  footer{max-width:1100px;margin:22px auto;padding:18px 20px;color:#555;font-size:13px;text-align:center}
  .toast{position:fixed;right:18px;bottom:18px;background:rgba(37,99,235,.95);color:white;padding:10px 14px;border-radius:8px;box-shadow:0 6px 18px rgba(15,23,42,.2);z-index:9999;font-weight:600;display:none}
  @media (min-width:900px){ .reports-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px} }
  @media (min-width:1200px){ .reports-grid{grid-template-columns:1fr 1fr 1fr} }
  .card table{display:block;width:100%;overflow-x:auto}
  #elogTable{table-layout:auto}
  @media print { nav, .controls, form, footer, .toast { display:none !important; } .reports-print{ display:block !important; } }
  form h2{color:var(--gsc-blue)!important;text-align:center;margin-top:0;}

  /* Loading box */
  #loading {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--card-bg);
    color: var(--gsc-blue);
    padding: 8px 12px;
    border-radius: 6px;
    box-shadow: 0 6px 18px rgba(15,23,42,.12);
    display: none;
    z-index: 99999;
    font-weight:700;
  }

  /* Dark mode */
  body.dark {
    --gsc-bg: #0b1220;
    --gsc-blue: #7fb5ff;
    --gsc-accent: #4aa3ff;
    --card-bg: #071227;
    --text: #e6eef8;
  }
  body.dark header { border-bottom-color: var(--gsc-blue); }
  body.dark th { background: #08345a; color: white; }

  /* top controls area */
  .top-controls {
    display:flex;
    gap:10px;
    align-items:center;
    justify-content:space-between;
    flex-wrap:wrap;
    margin-bottom:12px;
  }
  .left-controls { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .right-controls { display:flex; gap:8px; align-items:center; }

  /* search */
  #searchBox { width:260px; max-width:40vw; }

  /* log count */
  #logCount { font-weight:700; color:var(--gsc-blue); margin:6px 0; }
</style>
</head>
<body>
  <header>
    <div class="header-container">
      <img src="gs.jfif" class="gsc-logo" alt="GSC logo">
      <div class="header-text">
        <h1>Good Samaritan Colleges</h1>
        <p>Laboratory Usage System</p>
      </div>

      <!-- right side header controls -->
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <button id="darkToggle" title="Toggle dark mode" style="background:transparent;border:1px solid var(--gsc-blue);color:var(--gsc-blue);padding:8px 10px;border-radius:6px;cursor:pointer;font-weight:700;">Dark</button>
        <a id="githubLink" href="#" style="text-decoration:none;color:var(--gsc-blue);font-weight:600;display:none;">View on GitHub</a>
      </div>
    </div>
  </header>

  <nav>
    <div id="tab-logbook" class="tab active">Logbook</div>
    <div id="tab-reports" class="tab">Reports</div>
  </nav>

  <main>
    <!-- LOGBOOK -->
    <section id="view-logbook">
      <div class="card">
        <form id="elogForm">
          <h2>Log in Form</h2>

          <div class="row">
            <div class="col"><label for="faculty_name">Faculty Name</label><input id="faculty_name" placeholder="Ex. Juan Dela Cruz" required></div>
            <div class="col"><label for="department">Department</label><input id="department" placeholder="Ex. CNAM" required></div>
          </div>

          <div class="row">
            <div class="col"><label for="room_name">Laboratory Room Name</label><input id="room_name" placeholder="Ex. Chemistry Room" required></div>
            <div class="col"><label for="room_number">Room Number (Required)</label><input id="room_number" placeholder="Ex. 301"></div>
          </div>

          <div class="row">
            <div class="col"><label for="equipment">Major Equipment Used</label><input id="equipment" placeholder="Ex. Microscope-1"></div>
            <div class="col"><label for="date">Date Requested</label><input type="date" id="date" readonly></div>
          </div>

          <div class="row">
            <div class="col"><label for="time_in">Time-In</label><input type="time" id="time_in" required></div>
            <div class="col"><label for="time_out">Time-Out</label><input type="time" id="time_out" required></div>
          </div>

          <label for="purpose">Purpose / Activity</label><input id="purpose" placeholder="Ex. Experiment on solutions" required>
          <label for="remarks">Remarks (Optional)</label><textarea id="remarks" rows="2" placeholder="Remarks"></textarea>

          <div style="display:flex;gap:10px;justify-content:center;">
            <button class="primary" type="submit">Add Log</button>
            <button class="secondary" id="clearFormBtn" type="button">Clear</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="top-controls">
          <div class="left-controls">
            <div id="logCount">Total Logs: 0</div>
            <input id="searchBox" placeholder="Search logs..." />
          </div>
          <div class="right-controls controls">
            <button id="exportCsvBtn" class="secondary">Export Logs (CSV)</button>
            <button id="printLogsBtn" class="secondary">Print Logs</button>
          </div>
        </div>

        <table id="elogTable">
          <thead>
            <tr>
              <th>Timestamp</th><th>Faculty Name</th><th>Department</th><th>Room Name</th><th>Room #</th>
              <th>Equipment</th><th>Date</th><th>Time In</th><th>Time Out</th><th>Purpose</th><th>Remarks</th><th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- REPORTS -->
    <section id="view-reports" style="display:none;">
      <div class="card" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;">
        <div>
          <h2 style="margin:0;color:var(--gsc-blue)">Faculty Laboratory Usage Report</h2>
          <div style="margin-top:6px;color:#444">Generated: <span id="reportDatePretty"></span></div>
        </div>
        <button id="printReportsBtn" class="primary">Print Reports</button>
      </div>

      <div class="reports-grid" style="margin-top:12px">
        <div class="report-card card"><canvas id="chartRooms"></canvas><div class="list-area"><strong>Rooms</strong><div id="listRooms"></div></div></div>
        <div class="report-card card"><canvas id="chartEquipment"></canvas><div class="list-area"><strong>Equipment</strong><div id="listEquipment"></div></div></div>
        <div class="report-card card"><canvas id="chartFaculty"></canvas><div class="list-area"><strong>Faculty</strong><div id="listFaculty"></div></div></div>
      </div>

      <!-- printable lists -->
      <div class="reports-print" style="display:none; margin-top:18px;" id="reportsPrintContainer">
        <header style="text-align:center;margin-bottom:8px;">
          <img src="gs.jfif" alt="logo" style="width:80px">
          <div style="font-weight:700;font-size:18px;margin-top:6px;">Faculty Laboratory Usage Report â€” Good Samaritan Colleges</div>
          <div style="font-size:12px;margin-top:4px;" id="reportDatePrint"></div>
        </header>

        <div style="margin-top:10px;">
          <div style="margin-bottom:16px;">
            <strong>Rooms (counts)</strong>
            <div id="printListRooms"></div>
          </div>

          <div style="margin-bottom:16px;">
            <strong>Equipment (counts)</strong>
            <div id="printListEquipment"></div>
          </div>

          <div style="margin-bottom:16px;">
            <strong>Faculty (counts)</strong>
            <div id="printListFaculty"></div>
          </div>
        </div>

        <div class="print-footer" style="margin-top:20px;text-align:center;">
          <div style="font-weight:700;color:#234;">Good Samaritan Colleges</div>
          <div style="font-size:12px;color:#234;">Prepared by: Piolo L. Bernardino â€” Laboratory Custodian</div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    Â© 2025 Good Samaritan Colleges | Faculty Laboratory eLog System<br>
    Prepared by Piolo L. Bernardino â€” Laboratory Custodian
  </footer>

  <div id="toast" class="toast"></div>
  <div id="loading">Loadingâ€¦</div>

<script>
/* ---------- CONFIG ---------- */
const GOOGLE_FORM_ACTION="https://docs.google.com/forms/d/e/1FAIpQLSdPZLGabjI36s4iFdU-grRUK0ouLvoYrkV391MLxPrRWdZiHQ/formResponse";
const FORM_ENTRY={
  faculty_name:"entry.694323400",
  department:"entry.1656788187",
  room_name:"entry.1132289973",
  room_number:"entry.19898501",
  equipment:"entry.743283452",
  date:"entry.1998901142",
  time_in:"entry.736543893",
  time_out:"entry.1466121044",
  purpose:"entry.589165766",
  remarks:"entry.1595227859"
};
const SHEET_ID="1BFmqX4hjDp73GpYzFZFTwx22l-l5WtbU4UPh2ncr4hs";
const SHEET_NAME="Form Responses 1";

/* ---------- DOM ---------- */
const form = document.getElementById('elogForm');
const tableBody = document.querySelector('#elogTable tbody');
const exportCsvBtn = document.getElementById('exportCsvBtn');
const printLogsBtn = document.getElementById('printLogsBtn');
const printReportsBtn = document.getElementById('printReportsBtn');
const toastEl = document.getElementById('toast');
const loadingEl = document.getElementById('loading');
const tabLog = document.getElementById('tab-logbook');
const tabReports = document.getElementById('tab-reports');
const viewLog = document.getElementById('view-logbook');
const viewReports = document.getElementById('view-reports');
const logCountEl = document.getElementById('logCount');
const searchBox = document.getElementById('searchBox');
const darkToggle = document.getElementById('darkToggle');

let logs = JSON.parse(localStorage.getItem('facultyLogs')) || [];
let chartRooms, chartEquipment, chartFaculty;

/* ---------- HELPERS ---------- */
function makeId(){return Date.now()+Math.floor(Math.random()*1000);}
function showToast(msg, duration=3000){ toastEl.textContent = msg; toastEl.style.display = 'block'; setTimeout(()=> toastEl.style.display = 'none', duration); }
function escapeHtml(s){ return s? String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])) : ''; }

/* ---------- RENDER ---------- */
function renderTable(){
  tableBody.innerHTML = '';
  logs.forEach(item=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${new Date(item.created_at).toLocaleString()}</td>
      <td>${escapeHtml(item.faculty_name)}</td>
      <td>${escapeHtml(item.department)}</td>
      <td>${escapeHtml(item.room_name)}</td>
      <td>${escapeHtml(item.room_number)}</td>
      <td>${escapeHtml(item.equipment)}</td>
      <td>${escapeHtml(item.date)}</td>
      <td>${escapeHtml(item.time_in)}</td>
      <td>${escapeHtml(item.time_out)}</td>
      <td>${escapeHtml(item.purpose)}</td>
      <td>${escapeHtml(item.remarks)}</td>
      <td><button class="secondary" onclick="deleteLog(${item._id})">Delete</button></td>
    `;
    tableBody.appendChild(tr);
  });
  localStorage.setItem('facultyLogs', JSON.stringify(logs));
  logCountEl.textContent = 'Total Logs: ' + logs.length;
  updateReports();
  applySearchFilter(); // keep filter after render
}

/* ---------- FORM DEFAULTS ---------- */
function setDateTimeNowToForm(){
  const now = new Date();
  const isoDate = now.toISOString().split('T')[0];
  const hh = String(now.getHours()).padStart(2,'0'), mm = String(now.getMinutes()).padStart(2,'0');
  const dateEl = document.getElementById('date');
  dateEl.value = isoDate;
  // ensure date cannot be earlier than today (disable past)
  dateEl.setAttribute('min', isoDate);
  // default time_in to now
  document.getElementById('time_in').value = `${hh}:${mm}`;
}

/* ---------- GOOGLE FORM SYNC (no-cors) ---------- */
async function uploadToGoogleForm(obj){
  if (!GOOGLE_FORM_ACTION || GOOGLE_FORM_ACTION.includes('YOUR_FORM_ID')) return;
  try {
    const fd = new FormData();
    for (const k in FORM_ENTRY){
      fd.append(FORM_ENTRY[k], obj[k] || '');
    }
    await fetch(GOOGLE_FORM_ACTION, { method:'POST', mode:'no-cors', body: fd });
    showToast('âœ… Log added & synced to Google Sheets');
  } catch(err){
    console.error('Form upload error', err);
    showToast('âš ï¸ Saved locally â€” sync failed');
  }
}

/* ---------- SUBMIT ---------- */
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const newItem = {
    _id: makeId(),
    created_at: Date.now(),
    faculty_name: document.getElementById('faculty_name').value.trim(),
    department: document.getElementById('department').value.trim(),
    room_name: document.getElementById('room_name').value.trim(),
    room_number: document.getElementById('room_number').value.trim(),
    equipment: document.getElementById('equipment').value.trim(),
    date: document.getElementById('date').value,
    time_in: document.getElementById('time_in').value,
    time_out: document.getElementById('time_out').value,
    purpose: document.getElementById('purpose').value.trim(),
    remarks: document.getElementById('remarks').value.trim()
  };

  logs.push(newItem);
  renderTable();
  form.reset();
  setDateTimeNowToForm();
  showToast('âœ… Log added successfully!');
  uploadToGoogleForm(newItem);
});

/* ---------- CLEAR ---------- */
document.getElementById('clearFormBtn').addEventListener('click', ()=>{
  form.reset();
  setDateTimeNowToForm();
});

/* ---------- DELETE ---------- */
window.deleteLog = function(id){
  if (!confirm('Delete this entry?')) return;
  logs = logs.filter(x => Number(x._id) !== Number(id));
  renderTable();
  showToast('ðŸ—‘ï¸ Entry deleted successfully');
};

/* ---------- EXPORT CSV ---------- */
exportCsvBtn.addEventListener('click', ()=>{
  if (!logs.length){ showToast('âš ï¸ No logs to export'); return; }
  const headers = ['Timestamp','Faculty Name','Department','Room Name','Room #','Equipment Used','Date','Time In','Time Out','Purpose','Remarks'];
  const rows = logs.map(r => [
    new Date(r.created_at).toLocaleString(), r.faculty_name, r.department, r.room_name, r.room_number,
    r.equipment, r.date, r.time_in, r.time_out, r.purpose, r.remarks
  ]);
  const csv = [headers].concat(rows).map(r => r.map(c=>`"${String(c||'').replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob = new Blob([csv], { type:'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = `faculty_elog_export_${(new Date()).toISOString().slice(0,10)}.csv`; a.click();
  URL.revokeObjectURL(url);
  showToast('âœ… Logs exported as CSV');
});

/* ---------- PRINT ---------- */
printLogsBtn.addEventListener('click', ()=> window.print());
printReportsBtn.addEventListener('click', ()=> {
  tabReports.click();
  // show printable section then print
  document.querySelectorAll('.reports-print').forEach(el=> el.style.display='block');
  setTimeout(()=> { window.print(); setTimeout(()=> document.querySelectorAll('.reports-print').forEach(el=> el.style.display='none'), 300); }, 300);
});

/* ---------- TABS ---------- */
tabLog.addEventListener('click', () => {
  tabLog.classList.add('active'); tabReports.classList.remove('active');
  viewLog.style.display = ''; viewReports.style.display = 'none';
});
tabReports.addEventListener('click', () => {
  tabReports.classList.add('active'); tabLog.classList.remove('active');
  viewReports.style.display = ''; viewLog.style.display = 'none';
  fetchFromSheet(); // load live data when opening reports
});

/* ---------- REPORTS & CHARTS ---------- */
function computeCounts(){
  const rooms = {}, equipment = {}, faculty = {};
  logs.forEach(l => {
    const rn = (l.room_name||'(No room)').trim();
    const eq = (l.equipment||'(No equipment)').trim();
    const fac = (l.faculty_name||'(No name)').trim();
    rooms[rn] = (rooms[rn]||0) + 1;
    equipment[eq] = (equipment[eq]||0) + 1;
    faculty[fac] = (faculty[fac]||0) + 1;
  });
  return { rooms, equipment, faculty };
}

function populateList(container, obj){
  container.innerHTML = '';
  const items = Object.entries(obj).sort((a,b)=>b[1]-a[1]);
  if (!items.length){ container.innerHTML = '<div style="color:#666;padding:6px">No entries</div>'; return; }
  items.forEach(([k,v])=>{
    const div = document.createElement('div'); div.className = 'list-item';
    div.innerHTML = `<div>${k}</div><div>${v}</div>`;
    container.appendChild(div);
  });
}

function updateChart(canvasId, obj, instance){
  const ctx = document.getElementById(canvasId).getContext('2d');
  const labels = Object.keys(obj);
  const data = Object.values(obj);
  if (instance){
    instance.data.labels = labels;
    instance.data.datasets[0].data = data;
    instance.update();
    return instance;
  }
  return new Chart(ctx, {
    type: 'bar',
    data: { labels, datasets: [{ label: '# of uses', data, backgroundColor: labels.map(()=> 'rgba(37,99,235,0.75)') }] },
    options: { maintainAspectRatio:false, plugins:{ legend:{display:false} }, scales:{ y:{ beginAtZero:true, precision:0 } } }
  });
}

function updateReports(){
  document.getElementById('reportDatePretty').textContent = new Date().toLocaleString();
  document.getElementById('reportDatePrint').textContent = new Date().toLocaleString();
  const counts = computeCounts();
  populateList(document.getElementById('listRooms'), counts.rooms);
  populateList(document.getElementById('listEquipment'), counts.equipment);
  populateList(document.getElementById('listFaculty'), counts.faculty);
  populateList(document.getElementById('printListRooms'), counts.rooms || {});
  populateList(document.getElementById('printListEquipment'), counts.equipment || {});
  populateList(document.getElementById('printListFaculty'), counts.faculty || {});
  chartRooms = updateChart('chartRooms', counts.rooms, chartRooms);
  chartEquipment = updateChart('chartEquipment', counts.equipment, chartEquipment);
  chartFaculty = updateChart('chartFaculty', counts.faculty, chartFaculty);
}

/* ---------- LIVE REPORT FETCH ---------- */
async function fetchFromSheet(){
  loadingEl.style.display = 'block';
  try{
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(SHEET_NAME)}`;
    const res = await fetch(url);
    if (!res.ok) throw new Error('Fetch failed');
    const text = await res.text();
    // parse CSV gently (commas inside values will split; Google output usually simple)
    const rows = text.trim().split("\n").map(r => {
      // remove leading/trailing double quotes and split on "," occurrences
      const cols = [];
      let cur = '', inQuotes = false;
      for (let i=0;i<r.length;i++){
        const ch = r[i];
        if (ch === '"' ) { inQuotes = !inQuotes; continue; }
        if (ch === ',' && !inQuotes) { cols.push(cur); cur=''; continue; }
        cur += ch;
      }
      cols.push(cur);
      return cols;
    });
    // first row is headers -> skip
    if (rows.length <= 1) { loadingEl.style.display = 'none'; showToast('âš ï¸ No live rows found'); return; }
    rows.shift();
    // map to logs
    logs = rows.map(r => ({
      _id: makeId(),
      created_at: Date.now(),
      faculty_name: r[1] || '',
      department: r[2] || '',
      room_name: r[3] || '',
      room_number: r[4] || '',
      equipment: r[5] || '',
      date: r[6] || '',
      time_in: r[7] || '',
      time_out: r[8] || '',
      purpose: r[9] || '',
      remarks: r[10] || ''
    }));
    renderTable();
    showToast('ðŸ“Š Live data loaded from Google Sheets');
  } catch(err){
    console.error(err);
    showToast('âš ï¸ Could not load live data (CORS / access may block this).');
  } finally {
    loadingEl.style.display = 'none';
  }
}

/* ---------- AUTO-REFRESH while on Reports tab ---------- */
setInterval(()=> {
  if (viewReports.style.display !== 'none') fetchFromSheet();
}, 60000);

/* ---------- SEARCH FILTER ---------- */
function applySearchFilter(){
  const term = (searchBox.value || '').toLowerCase().trim();
  [...tableBody.querySelectorAll('tr')].forEach(row=>{
    if (!term) { row.style.display = ''; return; }
    row.style.display = row.innerText.toLowerCase().includes(term) ? '' : 'none';
  });
}
searchBox.addEventListener('input', applySearchFilter);

/* ---------- DARK MODE ---------- */
darkToggle.addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  darkToggle.textContent = isDark ? 'Light' : 'Dark';
  localStorage.setItem('elog_dark', isDark ? '1' : '0');
});
if (localStorage.getItem('elog_dark') === '1') {
  document.body.classList.add('dark');
  darkToggle.textContent = 'Light';
}

/* ---------- PREVENT NAV AWAY WHEN FORM TYPED ---------- */
window.addEventListener('beforeunload', e => {
  if (document.getElementById('faculty_name').value || document.getElementById('purpose').value) {
    e.preventDefault();
    e.returnValue = '';
  }
});

/* ---------- INIT ---------- */
setDateTimeNowToForm();
renderTable();

// expose fetchFromSheet to console if needed
window.fetchFromSheet = fetchFromSheet;
</script>
</body>
</html>
